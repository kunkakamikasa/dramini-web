(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[882],{1894:function(e,t,r){Promise.resolve().then(r.bind(r,190))},190:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return b}});var n=r(7437),o=r(2265),s=r(2869),a=r(9763);let i=(0,a.Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),c=(0,a.Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);var l=r(3145),u=r(5974),d=r(3276),f=r(6595),h=r(6337),m=r(3548),p=r(4508);function x(e){let{poster:t,index:r=0,section:s="unknown",onWatch:a,onUnlock:i}=e,[c,x]=(0,o.useState)(!1);return(0,n.jsxs)("div",{className:(0,p.cn)("group relative cursor-pointer transition-all duration-300 hover:scale-105","w-full max-w-[200px] mx-auto"),onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),onClick:()=>{m.co.posterClick(t.id,r,s),null==a||a(t)},children:[(0,n.jsxs)("div",{className:"aspect-[9/16] rounded-xl overflow-hidden shadow-card",children:[(0,n.jsx)(l.default,{src:t.cover||t.poster,alt:t.title,fill:!0,className:"object-cover transition-transform duration-300 group-hover:scale-110"}),(0,n.jsx)("div",{className:(0,p.cn)("absolute inset-0 bg-black transition-opacity duration-300",c?"opacity-60":"opacity-0"),children:(0,n.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),m.co.posterClick(t.id,r,s),null==a||a(t)},className:"bg-white/20 backdrop-blur-sm rounded-full p-3 hover:bg-white/30 transition-colors",children:(0,n.jsx)(d.Z,{className:"h-6 w-6 text-white fill-white"})})})}),t.rating&&t.rating>4.5&&(0,n.jsx)("div",{className:"absolute top-2 right-2",children:(0,n.jsxs)(u.C,{variant:"secondary",className:"bg-yellow-500 text-black",children:[(0,n.jsx)(f.Z,{className:"h-3 w-3 mr-1"}),t.rating]})}),t.rating&&t.rating>4.5&&(0,n.jsx)("div",{className:"absolute top-2 left-2",children:(0,n.jsx)("button",{onClick:e=>{e.stopPropagation(),m.co.posterClick(t.id,r,s),null==i||i(t)},className:"bg-black/50 backdrop-blur-sm rounded-full p-2 hover:bg-black/70 transition-colors",children:(0,n.jsx)(h.Z,{className:"h-4 w-4 text-white"})})})]}),(0,n.jsxs)("div",{className:"mt-2 px-1",children:[(0,n.jsx)("h3",{className:"text-sm font-medium text-white truncate group-hover:text-gray-300 transition-colors",children:t.title}),t.year&&(0,n.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:t.year})]})]})}function g(e){let{items:t=[],title:r,showNavigation:a=!0,itemsPerView:l=3}=e,[u,d]=(0,o.useState)(0),[f,h]=(0,o.useState)(!1),[g,v]=(0,o.useState)(0),[b,y]=(0,o.useState)(0),j=(0,o.useRef)(null),w=Array.isArray(t)?t:[],k=Math.max(0,w.length-l),N=()=>{d(e=>e>=k?0:e+1)},C=()=>{d(e=>e<=0?k:e-1)},_=e=>{d(Math.max(0,Math.min(e,k)))};return((0,o.useEffect)(()=>{let e=e=>{e.target===j.current&&("ArrowLeft"===e.key?(e.preventDefault(),C()):"ArrowRight"===e.key&&(e.preventDefault(),N()))},t=j.current;return t&&(t.addEventListener("keydown",e),t.setAttribute("tabindex","0"),t.setAttribute("role","region"),t.setAttribute("aria-label",r||"Carousel")),()=>{t&&t.removeEventListener("keydown",e)}},[r]),(0,o.useEffect)(()=>{w.length>0&&w.slice(u,u+l).forEach((e,t)=>{m.co.posterImpression(e.id,u+t,r||"carousel")})},[u,w,l,r]),0===w.length)?(0,n.jsxs)("div",{className:"space-y-4",children:[r&&(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsx)("h2",{className:"text-3xl font-bold",children:r})}),(0,n.jsx)("div",{className:"text-center py-8 text-gray-400",children:"No content available"})]}):(0,n.jsxs)("div",{className:"space-y-4",children:[r&&(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h2",{className:"text-3xl font-bold",children:r}),a&&(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)(s.z,{variant:"outline",size:"icon",onClick:C,className:"border-2","aria-label":"Previous slide",children:(0,n.jsx)(i,{className:"h-4 w-4"})}),(0,n.jsx)(s.z,{variant:"outline",size:"icon",onClick:N,className:"border-2","aria-label":"Next slide",children:(0,n.jsx)(c,{className:"h-4 w-4"})})]})]}),(0,n.jsx)("div",{className:"hidden lg:block",children:(0,n.jsx)("div",{className:"grid gap-6",style:{gridTemplateColumns:"repeat(".concat(l,", 1fr)")},children:w.slice(u,u+l).map((e,t)=>(0,n.jsx)(x,{poster:e,index:u+t,section:r||"carousel"},e.id))})}),(0,n.jsx)("div",{className:"lg:hidden",children:(0,n.jsx)("div",{ref:j,className:"flex space-x-4 overflow-x-auto pb-4 scrollbar-hide",onMouseDown:e=>{var t,r;h(!0),v(e.pageX-((null===(t=j.current)||void 0===t?void 0:t.offsetLeft)||0)),y((null===(r=j.current)||void 0===r?void 0:r.scrollLeft)||0)},onMouseMove:e=>{if(!f||!j.current)return;e.preventDefault();let t=e.pageX-(j.current.offsetLeft||0);j.current.scrollLeft=b-(t-g)*2},onMouseUp:()=>{h(!1)},onMouseLeave:()=>{h(!1)},onTouchStart:e=>{var t,r;h(!0),v(e.touches[0].pageX-((null===(t=j.current)||void 0===t?void 0:t.offsetLeft)||0)),y((null===(r=j.current)||void 0===r?void 0:r.scrollLeft)||0)},onTouchMove:e=>{if(!f||!j.current)return;let t=e.touches[0].pageX-(j.current.offsetLeft||0);j.current.scrollLeft=b-(t-g)*2},onTouchEnd:()=>{h(!1)},style:{cursor:f?"grabbing":"grab"},children:w.map((e,t)=>(0,n.jsx)("div",{className:"flex-none w-48",children:(0,n.jsx)(x,{poster:e,index:t,section:r||"carousel"})},e.id))})}),a&&w.length>l&&(0,n.jsx)("div",{className:"flex justify-center space-x-2",children:Array.from({length:k+1}).map((e,t)=>(0,n.jsx)("button",{onClick:()=>_(t),className:(0,p.cn)("w-2 h-2 rounded-full transition-colors",t===u?"bg-primary":"bg-muted"),"aria-label":"Go to slide ".concat(t+1)},t))})]})}var v=r(9116);function b(){let[e,t]=(0,o.useState)([]),[r,s]=(0,o.useState)(!0);return((0,o.useEffect)(()=>{(async()=>{try{s(!0);let e=await (0,v.a)("/titles/top");if(e.ok&&e.data){let r=e.data.map(e=>({id:e.id,title:e.name,poster:e.poster_url||"/placeholder-poster.jpg",slug:e.slug,year:e.year,rating:e.rating}));t(r)}}catch(e){console.error("获取数据失败:",e)}finally{s(!1)}})()},[]),r)?(0,n.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-white text-xl",children:"加载中..."})}):(0,n.jsxs)("div",{className:"min-h-screen bg-gray-900 text-white p-8",children:[(0,n.jsx)("h1",{className:"text-4xl font-bold mb-8",children:"热门排行榜"}),(0,n.jsx)("section",{className:"mb-12",children:(0,n.jsx)(g,{items:e,title:"Most Popular",itemsPerView:4})})]})}},5974:function(e,t,r){"use strict";r.d(t,{C:function(){return i}});var n=r(7437);r(2265);var o=r(535),s=r(4508);let a=(0,o.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:r,...o}=e;return(0,n.jsx)("div",{className:(0,s.cn)(a({variant:r}),t),...o})}},2869:function(e,t,r){"use strict";r.d(t,{z:function(){return l}});var n=r(7437),o=r(2265),s=r(5293),a=r(535),i=r(4508);let c=(0,a.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=o.forwardRef((e,t)=>{let{className:r,variant:o,size:a,asChild:l=!1,...u}=e,d=l?s.g7:"button";return(0,n.jsx)(d,{className:(0,i.cn)(c({variant:o,size:a,className:r})),ref:t,...u})});l.displayName="Button"},3548:function(e,t,r){"use strict";function n(e,t){if(window.dataLayer){let r={type:e,data:t,timestamp:Date.now()};window.dataLayer.push(r)}}r.d(t,{co:function(){return o}});let o={pageView:function(e,t){n("page_view",{path:e,title:t})},posterClick:function(e,t,r){n("poster_click",{titleId:e,index:t,section:r})},posterImpression:function(e,t,r){n("poster_impression",{titleId:e,index:t,section:r})},categorySelect:function(e){n("category_select",{category:e})},heroCtaClick:function(e,t){n("hero_cta_click",{cta:e,pos:t})},paywallOpen:function(e,t){n("paywall_open",{titleId:e,episode:t})},checkoutStart:function(e,t){n("checkout_start",{planId:e,priceCents:t})},checkoutSuccess:function(e,t,r){n("checkout_success",{planId:e,priceCents:t,sessionId:r})},checkoutCancel:function(e,t){n("checkout_cancel",{planId:e,priceCents:t})},error:function(e,t){n("error",{error:e,context:t})}}},9116:function(e,t,r){"use strict";async function n(e){try{let t=await fetch("".concat("https://dramini-api.onrender.com/api/v1").concat(e));if(!t.ok)return{ok:!1,data:null,error:"HTTP ".concat(t.status)};let r=await t.json();return{ok:!0,data:r}}catch(e){return{ok:!1,data:null,error:e instanceof Error?e.message:"Unknown error"}}}r.d(t,{a:function(){return n}})},4508:function(e,t,r){"use strict";r.d(t,{T4:function(){return a},cn:function(){return s}});var n=r(1994),o=r(3335);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,o.m6)((0,n.W)(t))}function a(e){return"$".concat((e/100).toFixed(2))}},6337:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9763).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},3276:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9763).Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},6595:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9763).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},3145:function(e,t,r){"use strict";r.d(t,{default:function(){return o.a}});var n=r(8461),o=r.n(n)},8461:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return c},getImageProps:function(){return i}});let n=r(7043),o=r(5346),s=r(5878),a=n._(r(5084));function i(e){let{props:t}=(0,o.getImgProps)(e,{defaultLoader:a.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let c=s.Image},5523:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return n}});let n=r(7043)._(r(2265)).default.createContext(null)}},function(e){e.O(0,[413,878,971,117,744],function(){return e(e.s=1894)}),_N_E=e.O()}]);