(()=>{var e={};e.id=668,e.ids=[668],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6005:e=>{"use strict";e.exports=require("node:crypto")},9080:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>h,tree:()=>d}),t(3777),t(3127),t(5866);var a=t(3191),r=t(8716),l=t(7922),n=t.n(l),i=t(5231),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);t.d(s,c);let d=["",{children:["admin",{children:["analytics",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,3777)),"/Users/mayingkun/mkwork/cursorproject/H5/Dramini/app/admin/analytics/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,3127)),"/Users/mayingkun/mkwork/cursorproject/H5/Dramini/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/mayingkun/mkwork/cursorproject/H5/Dramini/app/admin/analytics/page.tsx"],x="/admin/analytics/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/admin/analytics/page",pathname:"/admin/analytics",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7749:(e,s,t)=>{Promise.resolve().then(t.bind(t,2723))},2723:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>p});var a=t(326),r=t(7577),l=t(3071),n=t(6557);let i=(0,n.Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var c=t(2714);let d=(0,n.Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),o=(0,n.Z)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),x=(0,n.Z)("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);var m=t(7069),h=t(4659),u=t(772);function p(){let[e,s]=(0,r.useState)("today"),[t,n]=(0,r.useState)("day"),[p,y]=(0,r.useState)([]),[j,f]=(0,r.useState)(null),[g,N]=(0,r.useState)(!0),[b,v]=(0,r.useState)(null),k=async()=>{try{N(!0);let s=new URLSearchParams({granularity:t,days:"today"===e?"1":"week"===e?"7":"30"}),a=await fetch(`/api/analytics/stats?${s}`),r=await a.json();r.success?y(r.data.stats||[]):v(r.error||"Failed to fetch analytics data")}catch(e){v("Network error occurred"),console.error("Analytics fetch error:",e)}finally{N(!1)}},w=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString();return b?a.jsx("div",{className:"container mx-auto px-4 py-8",children:a.jsx(l.Zb,{children:a.jsx(l.aY,{className:"flex items-center justify-center py-12",children:(0,a.jsxs)("div",{className:"text-center",children:[a.jsx(i,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),a.jsx("h2",{className:"text-xl font-semibold mb-2",children:"数据加载失败"}),a.jsx("p",{className:"text-gray-600 mb-4",children:b}),a.jsx(u.z,{onClick:()=>{v(null),k()},children:"重新加载"})]})})})}):(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Analytics Dashboard"}),a.jsx("p",{className:"text-gray-600",children:"网站访问统计与分析"})]}),(0,a.jsxs)("div",{className:"mb-6 flex flex-wrap gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"时间范围:"}),(0,a.jsxs)("select",{value:e,onChange:e=>s(e.target.value),className:"border rounded px-3 py-1",children:[a.jsx("option",{value:"today",children:"今天"}),a.jsx("option",{value:"week",children:"最近7天"}),a.jsx("option",{value:"month",children:"最近30天"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"统计粒度:"}),(0,a.jsxs)("select",{value:t,onChange:e=>n(e.target.value),className:"border rounded px-3 py-1",children:[a.jsx("option",{value:"hour",children:"小时"}),a.jsx("option",{value:"day",children:"天"}),a.jsx("option",{value:"month",children:"月"}),a.jsx("option",{value:"year",children:"年"})]})]})]}),j&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(l.ll,{className:"text-sm font-medium",children:"页面浏览量"}),a.jsx(c.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:w(j.today.pv)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[j.today.pv," 今天"]})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(l.ll,{className:"text-sm font-medium",children:"独立访客"}),a.jsx(d,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:w(j.today.uv)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[j.today.uv," 今天"]})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(l.ll,{className:"text-sm font-medium",children:"注册用户"}),a.jsx(o,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:w(j.today.registrations)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[j.today.registrations," 今天"]})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(l.ll,{className:"text-sm font-medium",children:"观看用户"}),a.jsx(x,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.aY,{children:[a.jsx("div",{className:"text-2xl font-bold",children:w(j.today.viewers)}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[j.today.viewers," 今天"]})]})]})]}),(0,a.jsxs)(l.Zb,{children:[a.jsx(l.Ol,{children:(0,a.jsxs)(l.ll,{className:"flex items-center gap-2",children:[a.jsx(m.Z,{className:"h-5 w-5"}),"详细数据 - ",(e=>{switch(e){case"today":return"今天";case"week":return"最近7天";case"month":return"最近30天";default:return e}})(e)," (",(e=>{switch(e){case"hour":return"小时";case"day":return"天";case"month":return"月";case"year":return"年";default:return e}})(t),"级统计)"]})}),a.jsx(l.aY,{children:g?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"}),a.jsx("span",{className:"ml-2",children:"加载中..."})]}):0===p.length?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"暂无数据"}):a.jsx("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"日期"}),a.jsx("th",{className:"text-left py-3 px-4",children:"页面浏览量 (PV)"}),a.jsx("th",{className:"text-left py-3 px-4",children:"独立访客 (UV)"}),a.jsx("th",{className:"text-left py-3 px-4",children:"注册用户"}),a.jsx("th",{className:"text-left py-3 px-4",children:"观看用户"})]})}),a.jsx("tbody",{children:p.map((e,s)=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"py-3 px-4",children:e.date}),a.jsx("td",{className:"py-3 px-4 font-mono",children:e.pv.toLocaleString()}),a.jsx("td",{className:"py-3 px-4 font-mono",children:e.uv.toLocaleString()}),a.jsx("td",{className:"py-3 px-4 font-mono",children:e.registrations.toLocaleString()}),a.jsx("td",{className:"py-3 px-4 font-mono",children:e.viewers.toLocaleString()})]},s))})]})})})]}),(0,a.jsxs)(l.Zb,{className:"mt-6",children:[a.jsx(l.Ol,{children:(0,a.jsxs)(l.ll,{className:"flex items-center gap-2",children:[a.jsx(h.Z,{className:"h-5 w-5 text-green-500"}),"第三方Analytics对比"]})}),(0,a.jsxs)(l.aY,{children:[a.jsx("p",{className:"text-gray-600 mb-4",children:"我们的Analytics系统已经与主流的第三方统计工具对齐，包括Google Analytics 4和Plausible。 数据偏差应该在\xb15-10%的合理范围内。"}),(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"验证方法"}),a.jsx("p",{className:"text-blue-800 text-sm",children:"请使用以下命令验证Analytics数据的准确性："}),a.jsx("code",{className:"block mt-2 p-2 bg-blue-100 rounded text-sm",children:"curl https://dramini-api.onrender.com/analytics/overview | jq"})]})]})]})]})}},4659:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(6557).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},2714:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(6557).Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},7069:(e,s,t)=>{"use strict";t.d(s,{Z:()=>a});let a=(0,t(6557).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},3777:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(8570).createProxy)(String.raw`/Users/mayingkun/mkwork/cursorproject/H5/Dramini/app/admin/analytics/page.tsx#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[276,103,427,794],()=>t(9080));module.exports=a})();