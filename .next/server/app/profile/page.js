(()=>{var e={};e.id=178,e.ids=[178],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6005:e=>{"use strict";e.exports=require("node:crypto")},4238:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>h,tree:()=>d}),t(4591),t(3127),t(5866);var r=t(3191),a=t(8716),i=t(7922),l=t.n(i),n=t(5231),c={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let d=["",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,4591)),"/Users/mayingkun/mkwork/cursorproject/H5/Dramini/app/profile/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,3127)),"/Users/mayingkun/mkwork/cursorproject/H5/Dramini/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],o=["/Users/mayingkun/mkwork/cursorproject/H5/Dramini/app/profile/page.tsx"],x="/profile/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},3832:(e,s,t)=>{Promise.resolve().then(t.bind(t,6578))},6578:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>N});var r=t(326),a=t(7577),i=t(5047),l=t(434),n=t(772),c=t(3071),d=t(567),o=t(8281),x=t(3783),m=t(1810),h=t(9635),p=t(6557);let u=(0,p.Z)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var g=t(4893),y=t(8998),j=t(7069),f=t(4019);let b=(0,p.Z)("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);var v=t(8916);function N(){let e=(0,i.useRouter)(),[s,t]=(0,a.useState)(null),[p,N]=(0,a.useState)(!0),[w,k]=(0,a.useState)(!1),[P,Z]=(0,a.useState)([]),[C,S]=(0,a.useState)(null),[U,_]=(0,a.useState)("paypal"),z=async()=>{try{let e=await fetch("https://dramini-api.onrender.com/api/v1/payment-packages"),s=await e.json();if(s.ok&&s.packages){let e=s.packages.map(e=>({id:e.id,name:e.name,coins:e.coins,bonus:e.bonus||0,price:e.price,discount:e.discount,isNewUser:e.isNewUser||!1,description:e.description}));Z(e)}else Z([{id:"default1",name:"入门档",coins:500,bonus:50,price:4.99,discount:"+10%",isNewUser:!1,description:"新手推荐"}])}catch(e){console.error("Failed to fetch payment packages:",e),Z([{id:"default1",name:"入门档",coins:500,bonus:50,price:4.99,discount:"+10%",isNewUser:!1,description:"新手推荐"}])}},M=async()=>{if(!C){alert("Please select a package first");return}let e=localStorage.getItem("userId");if(!e){alert("Please login first");return}try{let s=await fetch(`https://dramini-api.onrender.com/api/v1/api/v1/user/purchase/checkout/${U}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tierKey:C.id,userId:e})});if(s.ok){let e=await s.json();e.checkoutUrl?window.location.href=e.checkoutUrl:alert("Payment initiated successfully!")}else alert("Payment failed. Please try again.")}catch(e){console.error("Payment error:",e),alert("Payment failed. Please try again.")}},$=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),H=e=>{let s=Math.floor(e/3600),t=Math.floor(e%3600/60);return s>0?`${s}h ${t}m`:`${t}m`};return p?r.jsx("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:r.jsx("div",{className:"text-center",children:r.jsx("div",{className:"text-lg mb-4",children:"Loading..."})})}):s?(0,r.jsxs)("div",{className:"min-h-screen bg-black text-white",children:[r.jsx("div",{className:"bg-gray-900 border-b border-gray-800",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex items-center justify-between h-16",children:[r.jsx("div",{className:"flex items-center gap-4",children:r.jsx(l.default,{href:"/",className:"text-xl font-bold text-red-500",children:"Dramini"})}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-yellow-400",children:[r.jsx(x.Z,{className:"w-5 h-5"}),r.jsx("span",{className:"font-semibold",children:s.coins})]}),(0,r.jsxs)(n.z,{variant:"ghost",onClick:()=>{localStorage.removeItem("userId"),localStorage.removeItem("userEmail"),localStorage.removeItem("userName"),e.push("/")},className:"text-gray-400 hover:text-white",children:[r.jsx(m.Z,{className:"w-4 h-4 mr-2"}),"Logout"]})]})]})})}),r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 lg:py-8",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-8",children:[r.jsx("div",{className:"lg:col-span-1",children:(0,r.jsxs)(c.Zb,{className:"bg-gray-900 border-gray-700",children:[r.jsx(c.Ol,{children:(0,r.jsxs)(c.ll,{className:"text-white flex items-center gap-2",children:[r.jsx(h.Z,{className:"w-5 h-5"}),"Profile"]})}),(0,r.jsxs)(c.aY,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-red-500 to-red-600 rounded-full flex items-center justify-center shadow-lg",children:r.jsx("span",{className:"text-white text-xl font-bold",children:s.name?.charAt(0).toUpperCase()||"U"})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-white",children:s.name}),r.jsx("p",{className:"text-gray-400",children:s.email})]})]}),r.jsx(o.Z,{className:"bg-gray-700"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-gray-300",children:"Coins Balance"}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-yellow-400",children:[r.jsx(x.Z,{className:"w-4 h-4"}),r.jsx("span",{className:"font-semibold",children:s.coins})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-gray-300",children:"Episodes Watched"}),r.jsx("span",{className:"text-white font-semibold",children:s.watchHistory.length})]})]}),r.jsx("div",{className:"pt-4",children:(0,r.jsxs)(n.z,{className:"w-full bg-yellow-600 hover:bg-yellow-700 text-black",onClick:()=>{z(),k(!0)},children:[r.jsx(x.Z,{className:"w-4 h-4 mr-2"}),"Top Up Coins"]})})]})]})}),r.jsx("div",{className:"lg:col-span-2",children:(0,r.jsxs)(c.Zb,{className:"bg-gray-900 border-gray-700",children:[r.jsx(c.Ol,{children:(0,r.jsxs)(c.ll,{className:"text-white flex items-center gap-2",children:[r.jsx(u,{className:"w-5 h-5"}),"Watch History"]})}),r.jsx(c.aY,{children:0===s.watchHistory.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[r.jsx(u,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-400 mb-2",children:"No watch history yet"}),r.jsx("p",{className:"text-gray-500 mb-6",children:"Start watching episodes to see your history here"}),r.jsx(l.default,{href:"/",children:(0,r.jsxs)(n.z,{className:"bg-red-600 hover:bg-red-700",children:[r.jsx(g.Z,{className:"w-4 h-4 mr-2"}),"Start Watching"]})})]}):r.jsx("div",{className:"space-y-4",children:s.watchHistory.map(e=>(0,r.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-800 rounded-lg hover:bg-gray-750 transition-colors",children:[r.jsx("div",{className:"w-20 h-12 bg-gray-700 rounded flex items-center justify-center",children:r.jsx(g.Z,{className:"w-6 h-6 text-gray-400"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("h4",{className:"text-white font-semibold truncate",children:e.title}),r.jsx("p",{className:"text-gray-400 text-sm",children:e.episode}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx(y.Z,{className:"w-3 h-3"}),H(e.duration)]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[r.jsx(j.Z,{className:"w-3 h-3"}),$(e.watchedAt)]})]})]}),r.jsx(n.z,{variant:"ghost",size:"sm",className:"text-gray-400 hover:text-white",children:r.jsx(g.Z,{className:"w-4 h-4"})})]},e.id))})})]})})]})}),w&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:r.jsx("div",{className:"bg-gray-900 rounded-lg max-w-md w-full max-h-[90vh] overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-bold text-white",children:"Top Up Coins"}),r.jsx(n.z,{variant:"ghost",size:"sm",onClick:()=>k(!1),className:"text-gray-400 hover:text-white",children:r.jsx(f.Z,{className:"w-4 h-4"})})]}),(0,r.jsxs)("div",{className:"space-y-4 mb-6",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("h3",{className:"text-lg font-semibold text-white",children:"充值金币"})}),(0,r.jsxs)("div",{className:"space-y-3",children:[P.filter(e=>e.isNewUser).map(e=>(0,r.jsxs)("div",{className:`bg-gradient-to-r from-red-500 to-pink-500 rounded-lg p-4 relative overflow-hidden cursor-pointer border-2 ${C?.id===e.id?"border-yellow-400 ring-2 ring-yellow-400/50":"border-transparent"} transition-all hover:scale-[1.02]`,onClick:()=>S(e),children:[r.jsx("div",{className:"absolute top-2 right-2",children:(0,r.jsxs)(d.C,{className:"bg-yellow-500 text-black font-bold",children:[r.jsx(b,{className:"w-3 h-3 mr-1"}),e.discount]})}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(x.Z,{className:"w-8 h-8 text-yellow-400"}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"text-sm opacity-90",children:"NEW USER ONLY"}),(0,r.jsxs)("div",{className:"text-2xl font-bold",children:[e.coins,r.jsx("span",{className:"text-lg",children:"Coins"})]}),(0,r.jsxs)("div",{className:"text-sm",children:["+",e.bonus," Bonus"]})]})]}),(0,r.jsxs)("div",{className:"ml-auto text-right",children:[(0,r.jsxs)("div",{className:"text-2xl font-bold",children:["$",e.price]}),r.jsx("div",{className:"text-sm opacity-75",children:e.description})]})]})]},e.id)),r.jsx("div",{className:"grid grid-cols-3 gap-3",children:P.filter(e=>!e.isNewUser).map(e=>(0,r.jsxs)("div",{className:`bg-gray-700 rounded-lg p-3 text-center relative cursor-pointer border-2 ${C?.id===e.id?"border-yellow-400 ring-2 ring-yellow-400/50":"border-transparent"} transition-all hover:scale-105`,onClick:()=>S(e),children:[e.discount&&r.jsx(d.C,{className:"absolute -top-2 left-1/2 transform -translate-x-1/2 bg-orange-500 text-white text-xs",children:e.discount}),(0,r.jsxs)("div",{className:e.discount?"mt-2":"",children:[r.jsx("div",{className:"text-lg font-bold",children:e.coins}),e.bonus>0?(0,r.jsxs)("div",{className:"text-xs",children:["+",e.bonus," Bonus"]}):r.jsx("div",{className:"text-xs text-gray-400",children:"Coins"}),(0,r.jsxs)("div",{className:"text-sm font-semibold mt-2",children:["$",e.price]}),r.jsx("div",{className:"text-xs text-gray-400 mt-1",children:e.description})]})]},e.id))})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-white font-semibold mb-3",children:"Payment Method"}),(0,r.jsxs)("div",{className:"flex gap-3",children:[r.jsx("div",{className:`flex-1 border-2 rounded-lg p-3 cursor-pointer transition-all ${"paypal"===U?"border-red-500 bg-red-500/10":"border-gray-600 bg-gray-800"}`,onClick:()=>_("paypal"),children:r.jsx("div",{className:"flex items-center justify-center",children:r.jsx("div",{className:"bg-blue-600 rounded px-3 py-2 text-white text-sm font-bold",children:"PayPal"})})}),r.jsx("div",{className:`flex-1 border-2 rounded-lg p-3 cursor-pointer transition-all ${"card"===U?"border-red-500 bg-red-500/10":"border-gray-600 bg-gray-800"}`,onClick:()=>_("card"),children:(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[r.jsx(v.Z,{className:"w-6 h-6 text-gray-400 mr-2"}),r.jsx("span",{className:"text-gray-400 text-sm",children:"Credit Card"})]})})]})]}),C&&r.jsx("div",{className:"bg-blue-900/30 border border-blue-500 rounded-lg p-3 mb-4",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-blue-300 text-sm",children:"已选择充值套餐："}),(0,r.jsxs)("div",{className:"text-white font-bold",children:[C.coins," 金币",C.bonus>0&&` + ${C.bonus} 奖励`,"- $",C.price]})]})}),(0,r.jsxs)(n.z,{className:"w-full bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 text-white font-bold py-4 text-lg rounded-lg transition-all",onClick:M,disabled:!C,children:[r.jsx(b,{className:"w-4 h-4 mr-2"}),"充值金币"]})]})})})]}):r.jsx("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-lg mb-4",children:"User not found"}),r.jsx(l.default,{href:"/login",children:r.jsx(n.z,{className:"bg-red-600 hover:bg-red-700",children:"Go to Login"})})]})})}},567:(e,s,t)=>{"use strict";t.d(s,{C:()=>n});var r=t(326);t(7577);var a=t(9360),i=t(7863);let l=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n({className:e,variant:s,...t}){return r.jsx("div",{className:(0,i.cn)(l({variant:s}),e),...t})}},8281:(e,s,t)=>{"use strict";t.d(s,{Z:()=>l});var r=t(326),a=t(7577),i=t(7863);let l=a.forwardRef(({className:e,orientation:s="horizontal",decorative:t=!0,...a},l)=>r.jsx("div",{ref:l,role:t?"none":"separator","aria-orientation":s,className:(0,i.cn)("shrink-0 bg-gray-600","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",e),...a}));l.displayName="Separator"},8998:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(6557).Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},3783:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(6557).Z)("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]])},8916:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(6557).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},1810:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(6557).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},4893:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(6557).Z)("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]])},7069:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(6557).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},9635:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(6557).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},4019:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});let r=(0,t(6557).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},434:(e,s,t)=>{"use strict";t.d(s,{default:()=>a.a});var r=t(9404),a=t.n(r)},5047:(e,s,t)=>{"use strict";var r=t(7389);t.o(r,"useParams")&&t.d(s,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(s,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},4591:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(8570).createProxy)(String.raw`/Users/mayingkun/mkwork/cursorproject/H5/Dramini/app/profile/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[276,103,427,404,794],()=>t(4238));module.exports=r})();